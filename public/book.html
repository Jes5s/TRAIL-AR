<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book Consultation | IronLinks</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <h1>Iron <span>works</span></h1>
    <nav>
      <a href="index.html">about us</a> |
      <a href="products.html">products</a> |
      <a href="book.html">book now</a> |
      <a href="#contact">contact</a>
    </nav>
</header>

<section class="book-section">
    <h2>Book a Consultation</h2>
    <form id="bookingForm" class="book-form">
        <input type="text" name="name" placeholder="Full Name" required>
        <input type="email" name="email" placeholder="Email" required>
        <input type="tel" name="phone" placeholder="Phone Number" required>
        <input type="date" name="date" required>
        <input type="time" name="time" required>
        <textarea name="request" placeholder="Additional Details"></textarea>
        <button type="submit">Submit Booking</button>
    </form>
</section>

<!-- Popup Modal -->
<div id="bookingModal">
  <div id="bookingModalContent">
    <p>Booking Successful!</p>
    <button id="closeModal">Close</button>
  </div>
</div>

<script>
const form = document.getElementById('bookingForm');
const modal = document.getElementById('bookingModal');
const closeBtn = document.getElementById('closeModal');

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const formData = new FormData(form);
  const data = Object.fromEntries(formData.entries());

  try {
    const res = await fetch('/book', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    const text = await res.text();

    if (!res.ok) throw new Error(text);

    modal.style.display = 'flex'; // Show popup
    form.reset();
  } catch (err) {
    alert(err.message);
    console.error(err);
  }
});

// Close modal
closeBtn.addEventListener('click', () => modal.style.display = 'none');
window.addEventListener('click', e => { if (e.target === modal) modal.style.display = 'none'; });
</script>
</body>
</html>
